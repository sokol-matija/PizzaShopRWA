@page
@model PizzaShopWebApp.Pages.Dashboard.DashboardIndexModel
@{
    ViewData["Title"] = "Dashboard";
    Layout = "_DashboardLayout";
}

<div class="restaurant-header">
    <div class="restaurant-info">
        <h1 class="restaurant-name">Dashboard</h1>
        <p class="restaurant-date">@Model.CurrentDate</p>
    </div>
    
    <div class="search-bar">
        <i class="bx bx-search"></i>
        <input type="text" placeholder="Search for food, coffee, etc.." />
    </div>
</div>

<!-- Stats Cards -->
<div class="stats-grid">
    <!-- Revenue Card -->
    <div class="stats-card">
        <div class="stats-header">
            <div class="stats-icon revenue">
                <i class='bx bx-dollar'></i>
            </div>
            <div class="stats-change @(Model.RevenueChangePercent >= 0 ? "positive" : "negative")">
                @(Model.RevenueChangePercent >= 0 ? "+" : "")@Model.RevenueChangePercent.ToString("0.00")% 
                <i class='bx @(Model.RevenueChangePercent >= 0 ? "bx-up-arrow-alt" : "bx-down-arrow-alt")'></i>
            </div>
        </div>
        <div class="stats-value">$@Model.TotalRevenue.ToString("N2")</div>
        <div class="stats-label">Total Revenue</div>
    </div>
    
    <!-- Orders Card -->
    <div class="stats-card">
        <div class="stats-header">
            <div class="stats-icon orders">
                <i class='bx bx-receipt'></i>
            </div>
            <div class="stats-change @(Model.OrdersChangePercent >= 0 ? "positive" : "negative")">
                @(Model.OrdersChangePercent >= 0 ? "+" : "")@Model.OrdersChangePercent.ToString("0.00")% 
                <i class='bx @(Model.OrdersChangePercent >= 0 ? "bx-up-arrow-alt" : "bx-down-arrow-alt")'></i>
            </div>
        </div>
        <div class="stats-value">@Model.TotalDishesOrdered</div>
        <div class="stats-label">Total Dish Ordered</div>
    </div>
    
    <!-- Customers Card -->
    <div class="stats-card">
        <div class="stats-header">
            <div class="stats-icon customers">
                <i class='bx bx-user'></i>
            </div>
            <div class="stats-change @(Model.CustomersChangePercent >= 0 ? "positive" : "negative")">
                @(Model.CustomersChangePercent >= 0 ? "+" : "")@Model.CustomersChangePercent.ToString("0.00")% 
                <i class='bx @(Model.CustomersChangePercent >= 0 ? "bx-up-arrow-alt" : "bx-down-arrow-alt")'></i>
            </div>
        </div>
        <div class="stats-value">@Model.TotalCustomers</div>
        <div class="stats-label">Total Customer</div>
    </div>
</div>

<!-- Order Report Section -->
<div class="order-report">
    <div class="order-report-header">
        <h2 class="order-report-title">Order Report</h2>
        <button class="filter-order-btn">
            <i class='bx bx-filter'></i>
            Filter Order
        </button>
    </div>
    
    <table class="order-table">
        <thead>
            <tr>
                <th class="order-table-header">Customer</th>
                <th class="order-table-header">Menu</th>
                <th class="order-table-header">Total Payment</th>
                <th class="order-table-header">Status</th>
            </tr>
        </thead>
        <tbody>
            @if (Model.RecentOrders != null && Model.RecentOrders.Any())
            {
                @foreach (var order in Model.RecentOrders)
                {
                    <tr class="order-table-row">
                        <td class="order-table-cell">
                            <div class="customer-info">
                                <img src="~/Images/basic_food_image.png" alt="Customer" class="customer-avatar">
                                <span class="customer-name">Order #@order.OrderNumber</span>
                            </div>
                        </td>
                        <td class="order-table-cell">
                            @if (order.Items.Any())
                            {
                                @order.Items.First().FoodName
                                @if (order.Items.Count > 1)
                                {
                                    <span> and @(order.Items.Count - 1) more item(s)</span>
                                }
                            }
                            else
                            {
                                <span>No items</span>
                            }
                        </td>
                        <td class="order-table-cell">$@order.TotalAmount.ToString("0.00")</td>
                        <td class="order-table-cell">
                            <span class="order-status @Model.GetStatusClass(order.Status)">@order.Status</span>
                        </td>
                    </tr>
                }
            }
            else
            {
                <tr class="order-table-row">
                    <td class="order-table-cell" colspan="4">No recent orders found.</td>
                </tr>
            }
        </tbody>
    </table>
</div>

<!-- Most Ordered Section -->
<div class="most-ordered">
    <div class="most-ordered-header">
        <h2 class="most-ordered-title">Most Ordered</h2>
        <div class="most-ordered-filter">
            <span>Today</span>
            <i class='bx bx-chevron-down'></i>
        </div>
    </div>
    
    <div class="most-ordered-items">
        @if (Model.MostOrderedItems != null && Model.MostOrderedItems.Any())
        {
            @foreach (var item in Model.MostOrderedItems)
            {
                <div class="most-ordered-item">
                    <img src="@(string.IsNullOrEmpty(item.ImageUrl) ? "/Images/basic_food_image.png" : item.ImageUrl)" 
                         alt="@item.Name" class="most-ordered-image">
                    <div class="most-ordered-details">
                        <h3 class="most-ordered-name">@item.Name</h3>
                        <p class="most-ordered-count">@(new Random().Next(50, 300)) dishes ordered</p>
                    </div>
                </div>
            }
        }
        else
        {
            <div class="most-ordered-item">
                <p>No popular dishes found.</p>
            </div>
        }
    </div>
    
    <button class="view-all-btn">View All</button>
</div>

<!-- Most Type of Order Section -->
<div class="most-ordered">
    <div class="most-ordered-header">
        <h2 class="most-ordered-title">Most Type of Order</h2>
        <div class="most-ordered-filter">
            <span>Today</span>
            <i class='bx bx-chevron-down'></i>
        </div>
    </div>
    
    <!-- This would be a chart in a real app, using placeholder text for now -->
    <div style="height: 200px; display: flex; align-items: center; justify-content: center; margin: 20px 0;">
        <p style="color: var(--text-muted);">Dine In: 200 customers</p>
        <p style="color: var(--text-muted); margin: 0 20px;">To Go: 122 customers</p>
        <p style="color: var(--text-muted);">Delivery: 264 customers</p>
    </div>
</div> 